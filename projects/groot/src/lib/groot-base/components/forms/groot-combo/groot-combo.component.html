<label for="{{name}}" *ngIf="label">
  {{label | translate}}
  <span *ngIf="required">*</span>
</label>
<div class="mb-2">
  <ng-select [items]="items"
             [placeholder]="(placeholder || label) | translate"
             [notFoundText]="notFoundText | translate"
             [addTagText]="addTagText | translate"
             [clearAllText]="clearAllText | translate"
             [loadingText]="loadingText | translate"
             [typeToSearchText]="typeToSearchText | translate"
             [required]="required"
             [labelForId]="name"
             [name]="name"
             #input="ngModel"
             [ngModel]="selectedValue"
             (ngModelChange)="writeValue($event)"
             [class.is-invalid]="input.invalid && !input.pristine"
             [disabled]="disabled"
             [bindLabel]="bindLabel"
             [bindValue]="bindValue"
             [multiple]="multiple"
             [closeOnSelect]="!multiple"
             [isOpen]="open"
             [class.groot-combo-listbox]="showAsListBox">

    <!-- Custom item templates -->
    <ng-template *ngIf="itemTemplate"
                 ng-option-tmp
                 let-item="item"
                 let-item$="item$"
                 let-index="index"
                 let-searchTerm="searchTerm">
      <ng-container
        *ngTemplateOutlet="itemTemplate; context: {item: item, item$: item$, index: index, searchTerm: searchTerm}">
      </ng-container>
    </ng-template>

    <!-- Custom label (selected object) template -->
    <ng-template *ngIf="labelTemplate || showAsListBox"
                 ng-label-tmp
                 let-item="item"
                 let-clear="clear"
                 let-label="label">
      <ng-container *ngIf="labelTemplate">
        <ng-container
          *ngTemplateOutlet="labelTemplate; context: {item: item, clear: clear, label: label}">
        </ng-container>
      </ng-container>

      <!-- Empty template for list box -->
    </ng-template>

    <!-- Custom template for multiple selections (replaces the label template) -->
    <ng-template *ngIf="multiLabelTemplate"
                 ng-multi-label-tmp
                 let-items="items"
                 let-clear="clear">
      <ng-container
        *ngTemplateOutlet="multiLabelTemplate; context: {items: items, clear: clear}">
      </ng-container>
    </ng-template>
  </ng-select>
  <div class="invalid-feedback" *ngIf="input.invalid && !input.pristine">
    {{'common.required' | translate}}
  </div>
  <small class="form-text text-muted" *ngIf="helpText">
    {{helpText | translate}}
  </small>
</div>
